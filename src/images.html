<!DOCTYPE html>
<html>
<head>
  <!-- Compiled and minified CSS -->
  <!--Import Google Icon Font-->
  <link href="//fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">

  <!-- Compiled and minified JavaScript -->

</head>
<body>
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>

<script src="/assets/camera51.js"></script>


<script src="/assets/dragdropfile/filereader.js"></script>
<script src="/assets/dragdropfile/script.js"></script>
<link href="/assets/dragdropfile/style.css" rel="stylesheet">
<style type="text/css">
  body{
    background-color: whitesmoke;

  }
  .resultImg {
    background-color: white;
    max-height: 200px;max-width: 200px;
  }
</style>

<div id="dropbox">
  <div class="text">
    Drop Images Here
  </div>
</div>
<div id="imageList">
</div>

<script>
  var apiUrl = "http://sandbox.malabi.co/Camera51Server/processImageAsync";
  var sqsUrl = "https://sqs.us-east-1.amazonaws.com/039264183653/DEVexample";

  var camera51ShowImage = new Camera51ShowImage(); // Object, functions for registering analytics events.
  camera51ShowImage.checkUpdatesSQS();


  function sqsListner(imageId, origImgUrl) {
//    console.log(origImgUrl);
    var settings = {
      //  "async": true,
      //  "crossDomain": true,
      "url": apiUrl,
      "method": "POST",
      "headers": {
        "content-type": "application/x-www-form-urlencoded"
      },
      "data": {
        "origImgUrl": origImgUrl,
        "token": "a059e275-52e0-4524-8050-3872fdd8d9af",
        "customerId": "3",
        "callbackURL": sqsUrl
      }
    };

    $.ajax(settings).done(function (response) {
      var imageCopyURL = response.response["imageCopyURL"];
      var element = document.getElementById("resultPreview-" + imageId);

      camera51ShowImage.addSearchArray(element, imageCopyURL);
    });
  };

    function malabiShowImageCallback(elem, img, processingResultCode){

      if(processingResultCode == 0){
        $(elem).prepend('<img id="theImg" src="'+img +'" style="width: 100%;height: auto;" />');
      }
      if(processingResultCode > 0) {
        $(elem).prepend('error ' + processingResultCode);
      }

    };



</script>
</body>
</html>

